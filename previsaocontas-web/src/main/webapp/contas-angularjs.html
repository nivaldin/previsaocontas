<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta http-equiv="Refresh" content="240;URL=#{facesContext.externalContext.requestContextPath}/contas/contas-angularjs.html" />
<title>Minhas Contas</title>

<script type="text/javascript" src="./resources/js/angular.min.js"></script>
<script type="text/javascript" src="./resources/js/angular-locale_pt-br.js"></script>
<script type="text/javascript" src="./resources/js/rw-money-mask.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script type="text/javascript">
	var app = angular.module('myapp', [ 'rw.moneymask' ]);

	app
			.controller(
					'myappcontroller',
					function($scope, $http, $timeout) {

						$scope.mostraEdicao = false
						$scope.listaAnos = []
						$scope.usuarioLogado = false
						$scope.tiposConta = []
						$scope.conta = {
							id : null,
							data_registro : null,
							descricao : "",
							valor : 0,
							dia_vencimento : null,
							numr_agrupador : 0,
							qtde_parcelas : 1,
							numr_parcela : 0,
							usuario : null,
							contaPai : null,
							valorParciais : 0,
							tipo : "D",
							data_mes : new Date(),
							flag_comum : "N"
						}
						$scope.usuario = {
							id : null,
							data_registro : null,
							login : "",
							senha : "",
							saldo : 0
						}
						$scope.contaFilha = JSON.parse(JSON
								.stringify($scope.conta))
						$scope.contaFilha.data_registro = new Date();

						$scope.contas = []
						$scope.contasFilhas = []
						$scope.userform = {
							usuario : "",
							senha : ""
						};

						$scope.msg = ""
						$scope.msgTitulo = "";
						$scope.msgClass = "";
						$scope.ano = (new Date()).getFullYear();
						$scope.mes = (new Date()).getMonth() + 1;

						getUsuarioLogado();
						iniciar();

						function iniciar() {
							if (usuario != null) {
								listaAnos();
							}
						}

						function msgErro(msg, statusHTTP) {
							$scope.msg = "";
							$scope.msg = msg;
							if (statusHTTP == 406) {
								$scope.msgTitulo = "Verifique!";
								$scope.msgClass = "alert alert-warning alert-dismissable fade in";
							} else if (statusHTTP == 500) {
								$scope.msgTitulo = "Erro!";
								$scope.msgClass = "alert alert-danger alert-dismissable fade in";
							}
						}
						function msgSucesso(msg) {
							$scope.msg = "";
							$scope.msg = msg;
							$scope.msgTitulo = "Sucesso";
							$scope.msgClass = "alert alert-success alert-dismissable fade in";
						}

						$scope.totalDespesaMes = 0;
						$scope.totalReceitaMes = 0;
						$scope.totalDespesaPrevistoMes = 0;
						$scope.totalReceitaPrevistoMes = 0;
						$scope.totalDespesaPrevistoAcumulado = 0;
						$scope.totalReceitaPrevistoAcumulado = 0;

						function resumoContas() {

							$http(
									{
										method : 'POST',
										url : 'rest/contas/resumoContas/'
												+ $scope.mes + '/' + $scope.ano,
										data : angular.toJson($scope.contas),
										headers : {
											'Content-Type' : 'application/json'
										}
									})
									.then(
											function successCallback(response) {
												$scope.totalDespesaMes = response.data.totalDespesaMes;
												$scope.totalReceitaMes = response.data.totalReceitaMes;
												$scope.totalDespesaPrevistoMes = response.data.totalDespesaPrevistoMes;
												$scope.totalReceitaPrevistoMes = response.data.totalReceitaPrevistoMes;
												$scope.totalDespesaPrevistoAcumulado = response.data.totalDespesaPrevistoAcumulado;
												$scope.totalReceitaPrevistoAcumulado = response.data.totalReceitaPrevistoAcumulado;
											},
											function errorCallback(response) {
												$scope.totalDespesaMes = 0;
												$scope.totalReceitaMes = 0;
												$scope.totalDespesaPrevistoMes = 0;
												$scope.totalReceitaPrevistoMes = 0;
												$scope.totalDespesaPrevistoAcumulado = 0;
												$scope.totalReceitaPrevistoAcumulado = 0;
												msgErro(response.data.mensagem,
														response.status)
											});

						}

						$scope.salvar = function() {
							$http({
								method : 'POST',
								url : 'rest/contas/salvar/',
								data : angular.toJson($scope.conta),
								headers : {
									'Content-Type' : 'application/json'
								}
							}).then(
									function successCallback(response) {
										msgSucesso(response.data.mensagem);
										$scope.listarContas();
										$scope.novaConta();
									},
									function errorCallback(response) {
										msgErro(response.data.mensagem,
												response.status)
									});
						}

						$scope.alterarSaldo = function() {
							$http({
								method : 'POST',
								url : 'rest/usuario/alterarSaldo/',
								data : angular.toJson($scope.usuario),
								headers : {
									'Content-Type' : 'application/json'
								}
							}).then(
									function successCallback(response) {
										msgSucesso(response.data.mensagem);
										iniciar();
									},
									function errorCallback(response) {
										msgErro(response.data.mensagem,
												response.status)
									});
						}

						$scope.salvarFilha = function() {

							$scope.contaFilha.data_registro = new Date();
							$scope.contaFilha.data_mes = $scope.conta.data_mes;
							$scope.contaFilha.flag_comum = $scope.conta.flag_comum;
							$scope.contaFilha.tipo = $scope.conta.tipo;
							$scope.contaFilha.status = "A";
							$scope.contaFilha.usuario = $scope.conta.usuario;
							$scope.contaFilha.contaPai = $scope.conta;

							$http({
								method : 'POST',
								url : 'rest/contas/salvar/',
								data : angular.toJson($scope.contaFilha),
								headers : {
									'Content-Type' : 'application/json'
								}
							})
									.then(
											function successCallback(response) {
												msgSucesso(response.data.mensagem);
												$scope
														.listarContasFilhas($scope.conta.id);
												$scope.novaContaFilha();
											},
											function errorCallback(response) {
												msgErro(response.data.mensagem,
														response.status)
											});
						}

						$scope.salvarTodos = function() {
							if (confirm('Salvar todas as parcelas relacionadas e não pagas iguais a essa?') == false) {
								return;
							}
							$http({
								method : 'POST',
								url : 'rest/contas/salvarTodos/',
								data : angular.toJson($scope.conta),
								headers : {
									'Content-Type' : 'application/json'
								}
							})
									.then(
											function successCallback(response) {
												msgSucesso(response.data.mensagem);
												$scope.listarContas();
												if (c.contaPai == null) {
													$scope
															.editarConta(response.data.objecto);
												} else {
													$scope
															.editarConta(response.data.objecto.contaPai);
												}
											},
											function errorCallback(response) {
												msgErro(response.data.mensagem,
														response.status)
											});
						}

						$scope.baixar = function(c) {
							$http({
								method : 'POST',
								url : 'rest/contas/baixar/',
								data : angular.toJson(c),
								headers : {
									'Content-Type' : 'application/json'
								}
							})
									.then(
											function successCallback(response) {
												msgSucesso(response.data.mensagem);
												$scope.listarContas();
												$scope.cancelarEdicao();
												if (c.contaPai == null) {
													$scope.cancelarEdicao();
												} else {
													$scope
															.editarConta(response.data.objecto.contaPai);
												}
											},
											function errorCallback(response) {
												msgErro(response.data.mensagem,
														response.status)
											});
						}

						$scope.cancelarBaixa = function(c) {
							$http({
								method : 'POST',
								url : 'rest/contas/cancelarBaixa/',
								data : angular.toJson(c),
								headers : {
									'Content-Type' : 'application/json'
								}
							})
									.then(
											function successCallback(response) {
												msgSucesso(response.data.mensagem);
												$scope.listarContas();
												if (c.contaPai == null) {
													$scope.cancelarEdicao();
												} else {
													$scope
															.editarConta(response.data.objecto.contaPai);
												}
											},
											function errorCallback(response) {
												msgErro(response.data.mensagem,
														response.status)
											});
						}

						$scope.excluir = function(c) {
							if (confirm('Excluir conta (' + c.descricao + ')') == false) {
								return;
							}
							$http({
								method : 'DELETE',
								url : 'rest/contas/excluir/',
								data : angular.toJson(c),
								headers : {
									'Content-Type' : 'application/json'
								}
							})
									.then(
											function successCallback(response) {
												msgSucesso(response.data.mensagem);
												$scope.listarContas();
												if (c.contaPai == null) {
													$scope.cancelarEdicao();
												} else {
													$scope
															.editarConta(response.data.objecto.contaPai);
												}
											},
											function errorCallback(response) {
												msgErro(response.data.mensagem,
														response.status)
											});
						}

						$scope.excluirTodos = function() {
							if (confirm('Excluir todas as parcelas relacionadas e não pagas?') == false) {
								return;
							}
							$http({
								method : 'DELETE',
								url : 'rest/contas/excluirTodos/',
								data : angular.toJson($scope.conta),
								headers : {
									'Content-Type' : 'application/json'
								}
							}).then(
									function successCallback(response) {
										msgSucesso(response.data.mensagem);
										$scope.listarContas();
										$scope.cancelarEdicao()
									},
									function errorCallback(response) {
										msgErro(response.data.mensagem,
												response.status)
									});
						}

						$scope.listarContas = function() {
							$scope.cancelarEdicao();

							$http(
									{
										method : 'GET',
										url : 'rest/contas/' + $scope.mes + '/'
												+ $scope.ano
									}).then(
									function successCallback(response) {
										$scope.contas = response.data;
										getUsuarioLogado();
										resumoContas();
									},
									function errorCallback(response) {
										$scope.contas = [];
										msgErro(response.data.mensagem,
												response.status)
									});
						}

						$scope.listarContasFilhas = function(idPai) {
							$http({
								method : 'GET',
								url : 'rest/contas/contasFilhas/' + idPai
							}).then(
									function successCallback(response) {
										$scope.contasFilhas = response.data;
									},
									function errorCallback(response) {
										$scope.contasFilhas = [];
										msgErro(response.data.mensagem,
												response.status)
									});
						}

						function listaAnos() {
							$http({
								method : 'GET',
								url : 'rest/anos',
							})
									.then(
											function successCallback(response) {
												$scope.listaAnos = response.data.listaAnos;
												tiposConta();
											},
											function errorCallback(response) {
												$scope.listaAnos = [];
												msgErro(
														"Erro ao buscar lista de anos!",
														response.status)
											});
						}

						function getUsuarioLogado() {
							$http({
								method : 'GET',
								url : 'rest/login/usuarioLogado',
							})
									.then(
											function successCallback(response) {
												$scope.usuario = response.data.objeto;
												$scope.userform.usuario = $scope.usuario.login;
												$scope.userform.senha = '';
												disableLogin();
												$scope.usuarioLogado = true;
											},
											function errorCallback(response) {
												msgErro(response.data.mensagem,
														response.status);
											});
						}

						function tiposConta() {
							$http({
								method : 'GET',
								url : 'rest/tiposConta',
							})
									.then(
											function successCallback(response) {
												$scope.tiposConta = response.data.tiposConta;
												$scope.listarContas();
											},
											function errorCallback(response) {
												$scope.tiposConta = [];
												msgErro(
														"Erro ao buscar tipo Conta!",
														response.status)
											});
						}

						$scope.validaLogin = function() {
							
							if ($scope.userform.usuario == "" || $scope.userform.senha == "") {
								msgErro("Informar usuário e senha.", 406);
								return;
							}
							$http(
									{
										method : 'GET',
										url : 'rest/login/'
												+ $scope.userform.usuario + '/'
												+ $scope.userform.senha,
									}).then(
									function successCallback(response) {
										getUsuarioLogado();
										iniciar();
										msgSucesso(response.data.mensagem);
									},
									function errorCallback(response) {
										$scope.contas = [];
										msgErro(response.data.mensagem,
												response.status)
										$scope.usuarioLogado = false;
									});
						}

						$scope.logout = function() {
							$http({
								method : 'GET',
								url : 'rest/login/logout'
							}).then(
									function successCallback(response) {
										$scope.contas = [];
										enableLogin();
										msgSucesso(response.data.mensagem);
										$scope.userform.senha = '';
										$scope.usuarioLogado = false;
									},
									function errorCallback(response) {
										msgErro(response.data.mensagem,
												response.status)
									});
						}

						function disableLogin() {
							document.getElementById("usuario").disabled = true;
							document.getElementById("senha").disabled = true;
							document.getElementById("submit").disabled = true;
						}

						function enableLogin() {
							document.getElementById("usuario").disabled = false;
							document.getElementById("senha").disabled = false;
							document.getElementById("submit").disabled = false;
						}

						$scope.editarConta = function(c) {
							$scope.conta = JSON.parse(JSON.stringify(c));
							$scope.conta.data_mes = new Date(c.data_mes);
							document.getElementById("despesa").disabled = true;
							document.getElementById("receita").disabled = true;
							document.getElementById("qtdeParcelas").disabled = true;
							$scope.mostraEdicao = true;
							$scope.listarContasFilhas(c.id);
							location.href = "#editarConta";
						}

						$scope.cancelarEdicao = function() {
							$scope.novaConta();
							$scope.mostraEdicao = false;
						}

						$scope.novaConta = function() {
							$scope.conta = {
								id : null,
								data_registro : null,
								descricao : "",
								valor : 0,
								dia_vencimento : null,
								numr_agrupador : 0,
								qtde_parcelas : 1,
								numr_parcela : 1,
								usuario : null,
								contaPai : null,
								valorParciais : 0,
								tipo : "D",
								data_mes : new Date($scope.ano, $scope.mes - 1,
										1, new Date().getHours(), new Date()
												.getMinutes(), new Date()
												.getSeconds()),
								flag_comum : "N"
							}
							$scope.novaContaFilha();
							$scope.contasFilhas = [];
							document.getElementById("despesa").disabled = false;
							document.getElementById("receita").disabled = false;
							document.getElementById("qtdeParcelas").disabled = false;
							$scope.mostraEdicao = true;
							document.getElementById('descricao').focus();
						}

						$scope.novaContaFilha = function() {
							$scope.contaFilha = {
								id : null,
								data_registro : new Date(),
								descricao : "",
								valor : 0,
								dia_vencimento : null,
								numr_agrupador : 0,
								qtde_parcelas : 1,
								numr_parcela : 1,
								usuario : null,
								contaPai : null,
								valorParciais : 0,
								tipo : "D",
								data_mes : new Date(),
								flag_comum : "N"
							}
						}

						$scope.cssLinhaTabela = function(c) {

							css = [];
							css.cursor = "pointer";

							if (c.tipo == 'D') {
								if (c.status == "B") {
									css.color = "#DCBCB9";
								} else {
									if (c.valorParciais > 0) {
										css.color = "#A94442";
									} else {
										css.color = 'red';
									}
								}
							} else {

								if (c.status == "B") {
									css.color = "#C2D8C2";
								} else {
									if (c.valorParciais > 0) {
										css.color = '#3D803E';
									} else {
										css.color = 'green';
									}
								}
							}

							return css;
						}

					});
</script>

</head>
<body ng-app="myapp" ng-controller="myappcontroller">
	<div class="container-fluid">
		<div class="row" >
			<div class="col-sm-2">

				<div class="input-group">
					<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span> <input id="usuario" type="text" class="form-control input-sm" name="usuario" placeholder="Usuário" ng-model="userform.usuario">
				</div>
				<div class="input-group">
					<span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span> <input id="senha" type="password" class="form-control input-sm" name="password" placeholder="Senha" ng-model="userform.senha">
				</div>

				<button id="submit" type="submit" class="btn btn-default btn-sm" ng-click="validaLogin()">
					<span class="glyphicon glyphicon-log-in"> </span> Entrar
				</button>
				<button id="sair" type="submit" class="btn btn-default btn-sm" ng-click="logout()">
					<span class="glyphicon glyphicon-log-out"> </span> Sair
				</button>

				<div ng-hide="usuarioLogado == false">
					
					<hr>
					<div class="row">
						<div class="col-sm-12">
							<label>Resumo Mês</label>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span style="color: red" id="despesaMes">{{totalDespesaMes | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span style="color: green" id="ReceitaMes">{{totalReceitaMes | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span id="totalMes">{{totalReceitaMes - totalDespesaMes | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<label>Previsão Mês</label>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span style="color: red" id="despesaPrevistoMes">{{totalDespesaPrevistoMes | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span style="color: green" id="despesaPrevistoMes">{{totalReceitaPrevistoMes | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span type="text" id="totalPrevisaoMes">{{usuario.saldo + (totalReceitaPrevistoMes - totalDespesaPrevistoMes) | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<label>Prev. Acumulado</label>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span style="color: red" id="despesaPrevistoAcumulado">{{totalDespesaPrevistoAcumulado | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span style="color: green" id="receitaPrevistoAcumulado">{{totalReceitaPrevistoAcumulado | currency:'':2}}</span>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-12">
							<span id="totalAcumulado">{{usuario.saldo + (totalReceitaPrevistoAcumulado - totalDespesaPrevistoAcumulado) | currency:'':2}}</span>
						</div>
					</div>
					<hr>
					<label for="valorSaldo">Saldo</label>
					<div class="input-group">
						 <input type="text" id="valorSaldo" ng-model="usuario.saldo" size="10" money-mask class="form-control input-sm" />
						<div class="input-group-btn">
							<button id="alterarSaldo" type="submit" class="btn btn-default btn-sm" ng-click="alterarSaldo()">
								<i class="glyphicon glyphicon-save"> </i>
							</button>
						</div>
					</div>

				</div>
			</div>
			<div class="col-sm-10">

				<div class="form-group" style="position: fixed; z-index: 99; right: 10px; top: 5px;">
					<div ng-class="msgClass">
						<strong>{{msgTitulo}} </strong> <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a> {{msg}}
					</div>
				</div>
				<div ng-hide="usuarioLogado == false">

					<nav class="navbar navbar-default">
						<div class="container-fluid">
							<div class="navbar-header">
								<a class="navbar-brand" href="#"><select id="ano" ng-options="ano for ano in listaAnos" ng-model="ano"></select></a>
							</div>
							<ul class="nav navbar-nav">
								<li><a ng-click="mes = 1; listarContas();" href="#">Jan</a></li>
								<li><a ng-click="mes = 2; listarContas();" href="#">Fev</a></li>
								<li><a ng-click="mes = 3; listarContas();" href="#">Mar</a></li>
								<li><a ng-click="mes = 4; listarContas();" href="#">Abr</a></li>
								<li><a ng-click="mes = 5; listarContas();" href="#">Mai</a></li>
								<li><a ng-click="mes = 6; listarContas();" href="#">Jun</a></li>
								<li><a ng-click="mes = 7; listarContas();" href="#">Jul</a></li>
								<li><a ng-click="mes = 8; listarContas();" href="#">Ago</a></li>
								<li><a ng-click="mes = 9; listarContas();" href="#">Set</a></li>
								<li><a ng-click="mes = 10; listarContas();" href="#">Out</a></li>
								<li><a ng-click="mes = 11; listarContas();" href="#">Nov</a></li>
								<li><a ng-click="mes = 12; listarContas();" href="#">Dez</a></li>
							</ul>
						</div>
					</nav>
					<div class="table-responsive">
						<table id="tabelaContas" class="table table-hover table-striped table-bordered table-condensed">
							<thead>
								<tr>
									<th width="50"></th>
									<th width="5"></th>
									<th width="5"></th>
									<th>Descrição</th>
									<th>Valor</th>
									<th>Parciais</th>
									<th>Vcto</th>
									<th>Parcela</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="c in contas">
									<td><a ng-click="excluir(c)" href="#"> <span class="glyphicon glyphicon-trash"></span></a> <a ng-click="baixar(c)" ng-if="c.status=='A'" href="#" title="Baixar Conta"><span class="glyphicon glyphicon-folder-open"></span></a> <a ng-click="cancelarBaixa(c)" ng-if="c.status=='B'" href="#"
										title="Cancelar Baixa"
									><span class="glyphicon glyphicon-folder-close"></span></a></td>
									<td ng-style="{'background-color': c.tipo== 'D'? 'red':'green'}"></td>
									<td ng-style="{'background-color': c.flag_comum== 'S'? 'yellow': 'inherit'}"></td>
									<td ng-style="cssLinhaTabela(c)" ng-click="editarConta(c)">{{ c.descricao }}</td>
									<td ng-style="cssLinhaTabela(c)" ng-click="editarConta(c)">{{ c.valor | currency:"":2 }}</td>
									<td ng-style="cssLinhaTabela(c)" ng-click="editarConta(c)">{{ c.valorParciais | currency:"":2 }}</td>
									<td ng-style="cssLinhaTabela(c)" ng-click="editarConta(c)">{{ c.dia_vencimento }}</td>
									<td ng-style="cssLinhaTabela(c)" ng-click="editarConta(c)">{{ c.numr_parcela }} - {{ c.qtde_parcelas }}</td>
								</tr>
							</tbody>
						</table>
					</div>

					<button id="novaConta" ng-click="novaConta();" type="submit" class="btn btn-default">
						<span class="glyphicon glyphicon-plus"> </span> Nova
					</button>
					<button id="fechar" ng-click="mostraEdicao = false" type="submit" class="btn btn-default">
						<span class="glyphicon glyphicon-eye-close"> </span> Fechar
					</button>
					<div class="row" style="min-height: 10px !important">
						<div class="col-sm-12"></div>
					</div>
					<div id="editarConta" ng-hide="mostraEdicao == false">
						<div class="panel panel-default">
							<div class="panel-heading">Editar Conta</div>
							<div class="panel-body">
								<div class="row">
									<div class="col-sm-5">
										<div class="panel panel-default">
											<div class="panel-heading">Conta</div>
											<div class="panel-body">
												<div class="row">
													<div class="col-sm-12">
														<input id="despesa" type="radio" ng-model="conta.tipo" value="D"><label style="color: red;" for="despesa">Despesa</label> <input id="receita" type="radio" ng-model="conta.tipo" value="R"><label style="color: green;" for="receita">Receita</label> <input
															title="Conta Comun a todos os meses" type="checkbox" id="flagComun" ng-model="conta.flag_comum" size="30" ng-true-value="'S'" ng-false-value="'N'"
														><label style="color: yellow; background-color: lightgray" for="flagComun">Conta Comun</label>
													</div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<label for="descricao">Descrição</label><input type="text" id="descricao" ng-model="conta.descricao" size="30" class="form-control">

													</div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<label for="valor">Valor</label><input type="text" id="valor" ng-model="conta.valor" size="10" money-mask class="form-control">
													</div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<label for=Data>Data</label><input type="date" id="data" name="data" ng-model="conta.data_mes" class="form-control" />
													</div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<label for="vencimento">Vencimento</label><input type="number" id="vencimento" ng-model="conta.dia_vencimento" class="form-control">
													</div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<label for="parcela">Parcela</label><input disabled="disabled" type="text" id="parcela" ng-value="conta.numr_parcela + ' - ' + conta.qtde_parcelas" class="form-control">
													</div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<label for="qtdeParcelas">Parcelas</label><input type="number" id="qtdeParcelas" ng-model="conta.qtde_parcelas" class="form-control">
													</div>
												</div>
												<div class="row" style="min-height: 10px !important">
													<div class="col-sm-12"></div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<button id="salvar" ng-click="salvar();" type="submit" class="btn btn-default">
															<span class="glyphicon glyphicon-save"> </span> Salvar
														</button>
														<button id="salvarTodos" ng-hide="conta.qtde_parcelas == 1 || conta.id == null" ng-click="salvarTodos();" type="submit" class="btn btn-default" title="Salva todas as parcelas relacionadas não baixadas iguais a essa!">
															<span class="glyphicon glyphicon-save"> </span> Salvar Parcelas
														</button>
														<button id="excluirTodos" ng-hide="conta.qtde_parcelas == 1 || conta.id == null" ng-click="excluirTodos();" type="submit" class="btn btn-default" title="Exclui tdas as parcelas relacionadas não baixadas!">
															<span class="glyphicon glyphicon-trash"> </span> Excluir Parcelas
														</button>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class="col-sm-7">

										<div class="panel panel-default">
											<div class="panel-heading">Parciais</div>
											<div class="panel-body">
												<div class="row">
													<div class="col-sm-4">
														<label for="descricaoFilha">Descrição</label><input type="text" id="descricaoFilha" ng-model="contaFilha.descricao" size="30" class="form-control">
													</div>
													<div class="col-sm-4">
														<label for="valorFilha">Valor</label><input type="text" id="valorFilha" ng-model="contaFilha.valor" size="10" money-mask class="form-control">
													</div>
													<div class="col-sm-4">
														<label for=dataFilha>Data</label><input type="date" id="dataFilha" name="data" ng-model="contaFilha.data_registro" class="form-control" />
													</div>
												</div>
												<div class="row" style="min-height: 10px !important">
													<div class="col-sm-12"></div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<button id="salvar" ng-click="salvarFilha();" type="submit" class="btn btn-default">
															<span class="glyphicon glyphicon-save"> </span> Salvar
														</button>
													</div>
												</div>
												<div class="row" style="min-height: 10px !important">
													<div class="col-sm-12"></div>
												</div>
												<div class="row">
													<div class="col-sm-12">
														<div class="table-responsive" ng-hide="contasFilhas.length <= 0">
															<table id="tabelaParciais" class="table table-hover table-striped table-bordered table-condensed">
																<thead>
																	<tr>
																		<th width="50"></th>
																		<th>Descrição</th>
																		<th>Valor</th>
																		<th>Data Registro</th>
																	</tr>
																</thead>
																<tbody>
																	<tr ng-repeat="c in contasFilhas">
																		<td><a ng-click="excluir(c)" href="#"> <span class="glyphicon glyphicon-trash"></span></a> <a ng-click="baixar(c)" ng-if="c.status=='A'" href="#" title="Baixar Conta"><span class="glyphicon glyphicon-folder-open"></span></a> <a ng-click="cancelarBaixa(c)" ng-if="c.status=='B'"
																			href="#" title="Cancelar Baixa"
																		><span class="glyphicon glyphicon-folder-close"></span></a></td>
																		<td ng-style="cssLinhaTabela(c)">{{ c.descricao }}</td>
																		<td ng-style="cssLinhaTabela(c)">{{ c.valor | currency:"":2 }}</td>
																		<td ng-style="cssLinhaTabela(c)">{{ c.data_registro | date:'dd/MM/yyyy HH:mm:ss' }}</td>
																	</tr>
																</tbody>
															</table>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>

				<hr>
			</div>

		</div>
	</div>
</body>
</html>